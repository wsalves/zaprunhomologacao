{"ast":null,"code":"import React,{useEffect,useState,useContext,useRef}from\"react\";import Grid from\"@material-ui/core/Grid\";import FormControl from\"@material-ui/core/FormControl\";import TextField from\"@material-ui/core/TextField\";import useSettings from\"../../hooks/useSettings\";import{toast}from'react-toastify';import{makeStyles}from\"@material-ui/core/styles\";import{grey,blue}from\"@material-ui/core/colors\";import OnlyForSuperUser from\"../OnlyForSuperUser\";import useAuth from\"../../hooks/useAuth.js/index.js\";import{IconButton,InputAdornment}from\"@material-ui/core\";import{Colorize,AttachFile,Delete}from\"@material-ui/icons\";import ColorPicker from\"../ColorPicker\";import ColorModeContext from\"../../layout/themeContext\";import api from\"../../services/api\";import{getBackendUrl}from\"../../config\";import defaultLogoLight from\"../../assets/logo.png\";import defaultLogoDark from\"../../assets/logo-black.png\";import defaultLogoFavicon from\"../../assets/favicon.ico\";import ColorBoxModal from\"../ColorBoxModal/index.js\";const useStyles=makeStyles(theme=>({container:{paddingTop:theme.spacing(4),paddingBottom:theme.spacing(4)},fixedHeightPaper:{padding:theme.spacing(2),display:\"flex\",overflow:\"auto\",flexDirection:\"column\",height:240},tab:{borderRadius:4,width:\"100%\",\"& .MuiTab-wrapper\":{color:\"#128c7e\"},\"& .MuiTabs-flexContainer\":{justifyContent:\"center\"}},paper:{padding:theme.spacing(2),display:\"flex\",alignItems:\"center\",marginBottom:12,width:\"100%\"},cardAvatar:{fontSize:\"55px\",color:grey[500],backgroundColor:\"#ffffff\",width:theme.spacing(7),height:theme.spacing(7)},cardTitle:{fontSize:\"18px\",color:blue[700]},cardSubtitle:{color:grey[600],fontSize:\"14px\"},alignRight:{textAlign:\"right\"},fullWidth:{width:\"100%\"},selectContainer:{width:\"100%\",textAlign:\"left\"},colorAdorment:{width:20,height:20},uploadInput:{display:\"none\"},appLogoLightPreviewDiv:{backgroundColor:\"white\",padding:\"10px\",borderStyle:\"solid\",borderWidth:\"1px\",borderColor:\"#424242\",textAlign:\"center\"},appLogoDarkPreviewDiv:{backgroundColor:\"#424242\",padding:\"10px\",borderStyle:\"solid\",borderWidth:\"1px\",borderColor:\"white\",textAlign:\"center\"},appLogoFaviconPreviewDiv:{padding:\"10px\",borderStyle:\"solid\",borderWidth:\"1px\",borderColor:\"black\",textAlign:\"center\"},appLogoLightPreviewImg:{width:\"100%\",maxHeight:72,content:\"url(\"+theme.calculatedLogoLight()+\")\"},appLogoDarkPreviewImg:{width:\"100%\",maxHeight:72,content:\"url(\"+theme.calculatedLogoDark()+\")\"},appLogoFaviconPreviewImg:{width:\"100%\",maxHeight:72,content:\"url(\"+(theme.appLogoFavicon?theme.appLogoFavicon:\"\")+\")\"}}));export default function Whitelabel(props){const{settings}=props;const classes=useStyles();const[settingsLoaded,setSettingsLoaded]=useState({});const{getCurrentUserInfo}=useAuth();const[currentUser,setCurrentUser]=useState({});const{colorMode}=useContext(ColorModeContext);const[primaryColorLightModalOpen,setPrimaryColorLightModalOpen]=useState(false);const[primaryColorDarkModalOpen,setPrimaryColorDarkModalOpen]=useState(false);const logoLightInput=useRef(null);const logoDarkInput=useRef(null);const logoFaviconInput=useRef(null);const appNameInput=useRef(null);const[appName,setAppName]=useState(settingsLoaded.appName||\"\");const{update}=useSettings();function updateSettingsLoaded(key,value){if(key==='primaryColorLight'||key==='primaryColorDark'||key==='appName'){localStorage.setItem(key,value);};const newSettings={...settingsLoaded};newSettings[key]=value;setSettingsLoaded(newSettings);}useEffect(()=>{getCurrentUserInfo().then(u=>{setCurrentUser(u);});if(Array.isArray(settings)&&settings.length){var _settings$find,_settings$find2,_settings$find3,_settings$find4,_settings$find5,_settings$find6;const primaryColorLight=(_settings$find=settings.find(s=>s.key===\"primaryColorLight\"))===null||_settings$find===void 0?void 0:_settings$find.value;const primaryColorDark=(_settings$find2=settings.find(s=>s.key===\"primaryColorDark\"))===null||_settings$find2===void 0?void 0:_settings$find2.value;const appLogoLight=(_settings$find3=settings.find(s=>s.key===\"appLogoLight\"))===null||_settings$find3===void 0?void 0:_settings$find3.value;const appLogoDark=(_settings$find4=settings.find(s=>s.key===\"appLogoDark\"))===null||_settings$find4===void 0?void 0:_settings$find4.value;const appLogoFavicon=(_settings$find5=settings.find(s=>s.key===\"appLogoFavicon\"))===null||_settings$find5===void 0?void 0:_settings$find5.value;const appName=(_settings$find6=settings.find(s=>s.key===\"appName\"))===null||_settings$find6===void 0?void 0:_settings$find6.value;setAppName(appName||\"\");setSettingsLoaded({...settingsLoaded,primaryColorLight,primaryColorDark,appLogoLight,appLogoDark,appLogoFavicon,appName});}// eslint-disable-next-line react-hooks/exhaustive-deps\n},[settings]);async function handleSaveSetting(key,value){await update({key,value});updateSettingsLoaded(key,value);toast.success(\"Operação atualizada com sucesso.\");}const uploadLogo=async(e,mode)=>{if(!e.target.files){return;}const file=e.target.files[0];const formData=new FormData();formData.append(\"typeArch\",\"logo\");formData.append(\"mode\",mode);formData.append(\"file\",file);await api.post(\"/settings-whitelabel/logo\",formData,{onUploadProgress:event=>{let progress=Math.round(event.loaded*100/event.total);}}).then(response=>{updateSettingsLoaded(\"appLogo\".concat(mode),response.data);colorMode[\"setAppLogo\".concat(mode)](getBackendUrl()+\"/public/\"+response.data);}).catch(err=>{console.error(\"Houve um problema ao realizar o upload da imagem.\");console.log(err);});};return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Grid,{spacing:3,container:true},/*#__PURE__*/React.createElement(OnlyForSuperUser,{user:currentUser,yes:()=>/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Grid,{xs:12,sm:6,md:4,item:true},/*#__PURE__*/React.createElement(FormControl,{className:classes.selectContainer},/*#__PURE__*/React.createElement(TextField,{id:\"primary-color-light-field\",label:\"Cor Prim\\xE1ria Modo Claro\",variant:\"standard\",value:settingsLoaded.primaryColorLight||\"\",onClick:()=>setPrimaryColorLightModalOpen(true),InputProps:{startAdornment:/*#__PURE__*/React.createElement(InputAdornment,{position:\"start\"},/*#__PURE__*/React.createElement(\"div\",{style:{backgroundColor:settingsLoaded.primaryColorLight},className:classes.colorAdorment})),endAdornment:/*#__PURE__*/React.createElement(IconButton,{size:\"small\",color:\"default\",onClick:()=>setPrimaryColorLightModalOpen(true)},/*#__PURE__*/React.createElement(Colorize,null))}})),/*#__PURE__*/React.createElement(ColorBoxModal,{open:primaryColorLightModalOpen,handleClose:()=>setPrimaryColorLightModalOpen(false),onChange:color=>{handleSaveSetting(\"primaryColorLight\",\"#\".concat(color.hex));colorMode.setPrimaryColorLight(\"#\".concat(color.hex));},currentColor:settingsLoaded.primaryColorLight})),/*#__PURE__*/React.createElement(Grid,{xs:12,sm:6,md:4,item:true},/*#__PURE__*/React.createElement(FormControl,{className:classes.selectContainer},/*#__PURE__*/React.createElement(TextField,{id:\"primary-color-dark-field\",label:\"Cor Prim\\xE1ria Modo Escuro\",variant:\"standard\",value:settingsLoaded.primaryColorDark||\"\",onClick:()=>setPrimaryColorDarkModalOpen(true),InputProps:{startAdornment:/*#__PURE__*/React.createElement(InputAdornment,{position:\"start\"},/*#__PURE__*/React.createElement(\"div\",{style:{backgroundColor:settingsLoaded.primaryColorDark},className:classes.colorAdorment})),endAdornment:/*#__PURE__*/React.createElement(IconButton,{size:\"small\",color:\"default\",onClick:()=>setPrimaryColorDarkModalOpen(true)},/*#__PURE__*/React.createElement(Colorize,null))}})),/*#__PURE__*/React.createElement(ColorBoxModal,{open:primaryColorDarkModalOpen,handleClose:()=>setPrimaryColorDarkModalOpen(false),onChange:color=>{handleSaveSetting(\"primaryColorDark\",\"#\".concat(color.hex));colorMode.setPrimaryColorDark(\"#\".concat(color.hex));},currentColor:settingsLoaded.primaryColorDark})),/*#__PURE__*/React.createElement(Grid,{xs:12,sm:6,md:4,item:true},/*#__PURE__*/React.createElement(FormControl,{className:classes.selectContainer},/*#__PURE__*/React.createElement(TextField,{id:\"appname-field\",label:\"Nome do sistema\",variant:\"standard\",name:\"appName\",value:appName,inputRef:appNameInput,onChange:e=>{setAppName(e.target.value);},onBlur:async _=>{await handleSaveSetting(\"appName\",appName);colorMode.setAppName(appName||\"ZAPRUN\");}}))),/*#__PURE__*/React.createElement(Grid,{xs:12,sm:6,md:4,item:true},/*#__PURE__*/React.createElement(FormControl,{className:classes.selectContainer},/*#__PURE__*/React.createElement(TextField,{id:\"logo-light-upload-field\",label:\"Logotipo claro\",variant:\"standard\",value:settingsLoaded.appLogoLight||\"\",InputProps:{endAdornment:/*#__PURE__*/React.createElement(React.Fragment,null,settingsLoaded.appLogoLight&&/*#__PURE__*/React.createElement(IconButton,{size:\"small\",color:\"default\",onClick:()=>{handleSaveSetting(\"appLogoLight\",\"\");colorMode.setAppLogoLight(defaultLogoLight);}},/*#__PURE__*/React.createElement(Delete,null)),/*#__PURE__*/React.createElement(\"input\",{type:\"file\",id:\"upload-logo-light-button\",ref:logoLightInput,className:classes.uploadInput,onChange:e=>uploadLogo(e,\"Light\")}),/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"upload-logo-light-button\"},/*#__PURE__*/React.createElement(IconButton,{size:\"small\",color:\"default\",onClick:()=>{logoLightInput.current.click();}},/*#__PURE__*/React.createElement(AttachFile,null))))}}))),/*#__PURE__*/React.createElement(Grid,{xs:12,sm:6,md:4,item:true},/*#__PURE__*/React.createElement(FormControl,{className:classes.selectContainer},/*#__PURE__*/React.createElement(TextField,{id:\"logo-dark-upload-field\",label:\"Logotipo escuro\",variant:\"standard\",value:settingsLoaded.appLogoDark||\"\",InputProps:{endAdornment:/*#__PURE__*/React.createElement(React.Fragment,null,settingsLoaded.appLogoDark&&/*#__PURE__*/React.createElement(IconButton,{size:\"small\",color:\"default\",onClick:()=>{handleSaveSetting(\"appLogoDark\",\"\");colorMode.setAppLogoDark(defaultLogoDark);}},/*#__PURE__*/React.createElement(Delete,null)),/*#__PURE__*/React.createElement(\"input\",{type:\"file\",id:\"upload-logo-dark-button\",ref:logoDarkInput,className:classes.uploadInput,onChange:e=>uploadLogo(e,\"Dark\")}),/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"upload-logo-dark-button\"},/*#__PURE__*/React.createElement(IconButton,{size:\"small\",color:\"default\",onClick:()=>{logoDarkInput.current.click();}},/*#__PURE__*/React.createElement(AttachFile,null))))}}))),/*#__PURE__*/React.createElement(Grid,{xs:12,sm:6,md:4,item:true},/*#__PURE__*/React.createElement(FormControl,{className:classes.selectContainer},/*#__PURE__*/React.createElement(TextField,{id:\"logo-favicon-upload-field\",label:\"Favicon\",variant:\"standard\",value:settingsLoaded.appLogoFavicon||\"\",InputProps:{endAdornment:/*#__PURE__*/React.createElement(React.Fragment,null,settingsLoaded.appLogoFavicon&&/*#__PURE__*/React.createElement(IconButton,{size:\"small\",color:\"default\",onClick:()=>{handleSaveSetting(\"appLogoFavicon\",\"\");colorMode.setAppLogoFavicon(defaultLogoFavicon);}},/*#__PURE__*/React.createElement(Delete,null)),/*#__PURE__*/React.createElement(\"input\",{type:\"file\",id:\"upload-logo-favicon-button\",ref:logoFaviconInput,className:classes.uploadInput,onChange:e=>uploadLogo(e,\"Favicon\")}),/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"upload-logo-favicon-button\"},/*#__PURE__*/React.createElement(IconButton,{size:\"small\",color:\"default\",onClick:()=>{logoFaviconInput.current.click();}},/*#__PURE__*/React.createElement(AttachFile,null))))}}))),/*#__PURE__*/React.createElement(Grid,{xs:12,sm:6,md:4,item:true},/*#__PURE__*/React.createElement(\"div\",{className:classes.appLogoLightPreviewDiv},/*#__PURE__*/React.createElement(\"img\",{className:classes.appLogoLightPreviewImg,alt:\"light-logo-preview\"}))),/*#__PURE__*/React.createElement(Grid,{xs:12,sm:6,md:4,item:true},/*#__PURE__*/React.createElement(\"div\",{className:classes.appLogoDarkPreviewDiv},/*#__PURE__*/React.createElement(\"img\",{className:classes.appLogoDarkPreviewImg,alt:\"dark-logo-preview\"}))),/*#__PURE__*/React.createElement(Grid,{xs:12,sm:6,md:4,item:true},/*#__PURE__*/React.createElement(\"div\",{className:classes.appLogoFaviconPreviewDiv},/*#__PURE__*/React.createElement(\"img\",{className:classes.appLogoFaviconPreviewImg,alt:\"favicon-preview\"}))))})));}","map":null,"metadata":{},"sourceType":"module"}