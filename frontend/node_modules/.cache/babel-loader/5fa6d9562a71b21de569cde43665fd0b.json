{"ast":null,"code":"import React,{useEffect,useState,useContext}from\"react\";import QRCode from\"qrcode.react\";import toastError from\"../../errors/toastError\";import{makeStyles}from\"@material-ui/core/styles\";import{Dialog,DialogContent,Paper,Typography}from\"@material-ui/core\";import{i18n}from\"../../translate/i18n\";import api from\"../../services/api\";import{AuthContext}from\"../../context/Auth/AuthContext\";const useStyles=makeStyles(theme=>({root:{display:\"flex\",flexWrap:\"wrap\"}}));const QrcodeModal=_ref=>{let{open,onClose,whatsAppId}=_ref;const classes=useStyles();const[qrCode,setQrCode]=useState(\"\");const{user,socket}=useContext(AuthContext);useEffect(()=>{const fetchSession=async()=>{if(!whatsAppId)return;try{const{data}=await api.get(\"/whatsapp/\".concat(whatsAppId));setQrCode(data.qrcode);}catch(err){toastError(err);}};fetchSession();},[whatsAppId]);useEffect(()=>{if(!whatsAppId)return;const companyId=user.companyId;// const socket = socketConnection({ companyId, userId: user.id });\nconst onWhatsappData=data=>{if(data.action===\"update\"&&data.session.id===whatsAppId){setQrCode(data.session.qrcode);}if(data.action===\"update\"&&data.session.qrcode===\"\"){onClose();}};socket.on(\"company-\".concat(companyId,\"-whatsappSession\"),onWhatsappData);return()=>{socket.off(\"company-\".concat(companyId,\"-whatsappSession\"),onWhatsappData);};},[whatsAppId,onClose]);return/*#__PURE__*/React.createElement(Dialog,{open:open,onClose:onClose,maxWidth:\"lg\",scroll:\"paper\"},/*#__PURE__*/React.createElement(DialogContent,null,/*#__PURE__*/React.createElement(Paper,{elevation:0},/*#__PURE__*/React.createElement(Typography,{color:\"secondary\",gutterBottom:true},i18n.t(\"qrCode.message\")),/*#__PURE__*/React.createElement(\"div\",{className:classes.root},qrCode?/*#__PURE__*/React.createElement(QRCode,{value:qrCode,size:300,style:{backgroundColor:\"white\",padding:'5px'}}):/*#__PURE__*/React.createElement(\"span\",null,\"Aguardando pelo QR Code\")))));};export default React.memo(QrcodeModal);","map":null,"metadata":{},"sourceType":"module"}