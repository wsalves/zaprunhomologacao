{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import qs from'query-string';import*as Yup from\"yup\";import{useHistory}from\"react-router-dom\";import{Link as RouterLink}from\"react-router-dom\";import{toast}from\"react-toastify\";import{Formik,Form,Field}from\"formik\";import Avatar from\"@material-ui/core/Avatar\";import Button from\"@material-ui/core/Button\";import CssBaseline from\"@material-ui/core/CssBaseline\";import TextField from\"@material-ui/core/TextField\";import Link from\"@material-ui/core/Link\";import Grid from\"@material-ui/core/Grid\";import Box from\"@material-ui/core/Box\";import LockOutlinedIcon from\"@material-ui/icons/LockOutlined\";import Typography from\"@material-ui/core/Typography\";import{makeStyles}from\"@material-ui/core/styles\";import Container from\"@material-ui/core/Container\";import usePlans from'../../hooks/usePlans';import{i18n}from\"../../translate/i18n\";import{FormControl}from\"@material-ui/core\";import{InputLabel,MenuItem,Select}from\"@material-ui/core\";import{openApi}from\"../../services/api\";import toastError from\"../../errors/toastError\";import Autocomplete from\"@material-ui/lab/Autocomplete\";const useStyles=makeStyles(theme=>({root:{display:'flex',flexDirection:'row',height:'100vh',[theme.breakpoints.down('sm')]:{flexDirection:'column'}},leftSide:{flex:1,backgroundImage:\"url(/backgroundlogin.gif)\",backgroundSize:'cover',backgroundPosition:'center',display:'flex',alignItems:'center',justifyContent:'center',[theme.breakpoints.down('sm')]:{height:'50vh',backgroundSize:'contain',backgroundRepeat:'no-repeat'}},rightSide:{flex:1,display:'flex',alignItems:'center',justifyContent:'center',backgroundColor:theme.palette.background.default,[theme.breakpoints.down('sm')]:{height:'50vh'}},paper:{display:\"flex\",flexDirection:\"column\",alignItems:\"center\",padding:\"55px 30px\"},avatar:{margin:theme.spacing(1),backgroundColor:theme.palette.primary.main},form:{width:\"100%\",marginTop:theme.spacing(3)},submit:{margin:theme.spacing(3,0,2)}}));const UserSchema=Yup.object().shape({name:Yup.string().min(2,\"Too Short!\").max(50,\"Too Long!\").required(\"Required\"),companyName:Yup.string().min(2,\"Too Short!\").max(50,\"Too Long!\").required(\"Required\"),password:Yup.string().min(5,\"Too Short!\").max(50,\"Too Long!\"),email:Yup.string().email(\"Invalid email\").required(\"Required\"),phone:Yup.string().required(\"Required\")});const SignUp=()=>{const classes=useStyles();const history=useHistory();const{getPlanList}=usePlans();const[plans,setPlans]=useState([]);const[loading,setLoading]=useState(false);let companyId=null;const params=qs.parse(window.location.search);if(params.companyId!==undefined){companyId=params.companyId;}const initialState={name:\"\",email:\"\",password:\"\",phone:\"\",companyId,companyName:\"\",planId:\"\"};const[user]=useState(initialState);useEffect(()=>{setLoading(true);const fetchData=async()=>{const planList=await getPlanList({listPublic:\"false\"});setPlans(planList);setLoading(false);};fetchData();// eslint-disable-next-line react-hooks/exhaustive-deps\n},[]);const handleSignUp=async values=>{try{await openApi.post(\"/auth/signup\",values);toast.success(i18n.t(\"signup.toasts.success\"));history.push(\"/login\");}catch(err){toastError(err);}};return/*#__PURE__*/React.createElement(\"div\",{className:classes.root},/*#__PURE__*/React.createElement(\"div\",{className:classes.rightSide},/*#__PURE__*/React.createElement(Container,{component:\"main\",maxWidth:\"xs\"},/*#__PURE__*/React.createElement(CssBaseline,null),/*#__PURE__*/React.createElement(\"div\",{className:classes.paper},/*#__PURE__*/React.createElement(Avatar,{className:classes.avatar},/*#__PURE__*/React.createElement(LockOutlinedIcon,null)),/*#__PURE__*/React.createElement(Typography,{component:\"h1\",variant:\"h5\"},i18n.t(\"signup.title\")),/*#__PURE__*/React.createElement(Formik,{initialValues:user,enableReinitialize:true,validationSchema:UserSchema,onSubmit:(values,actions)=>{setTimeout(()=>{handleSignUp(values);actions.setSubmitting(false);},400);}},_ref=>{let{touched,errors,isSubmitting}=_ref;return/*#__PURE__*/React.createElement(Form,{className:classes.form},/*#__PURE__*/React.createElement(Grid,{container:true,spacing:2},/*#__PURE__*/React.createElement(Grid,{item:true,xs:12},/*#__PURE__*/React.createElement(Field,{as:TextField,variant:\"outlined\",fullWidth:true,id:\"companyName\",label:i18n.t(\"signup.form.company\"),error:touched.companyName&&Boolean(errors.companyName),helperText:touched.companyName&&errors.companyName,name:\"companyName\",autoComplete:\"companyName\",autoFocus:true})),/*#__PURE__*/React.createElement(Grid,{item:true,xs:12},/*#__PURE__*/React.createElement(Field,{as:TextField,autoComplete:\"name\",name:\"name\",error:touched.name&&Boolean(errors.name),helperText:touched.name&&errors.name,variant:\"outlined\",fullWidth:true,id:\"name\",label:i18n.t(\"signup.form.name\")// autoFocus\n})),/*#__PURE__*/React.createElement(Grid,{item:true,xs:12},/*#__PURE__*/React.createElement(Field,{as:TextField,variant:\"outlined\",fullWidth:true,id:\"email\",label:i18n.t(\"signup.form.email\"),name:\"email\",error:touched.email&&Boolean(errors.email),helperText:touched.email&&errors.email,autoComplete:\"email\",inputProps:{style:{textTransform:'lowercase'}}})),/*#__PURE__*/React.createElement(Grid,{item:true,xs:12},/*#__PURE__*/React.createElement(Field,{as:TextField,variant:\"outlined\",fullWidth:true,name:\"password\",error:touched.password&&Boolean(errors.password),helperText:touched.password&&errors.password,label:i18n.t(\"signup.form.password\"),type:\"password\",id:\"password\",autoComplete:\"current-password\"})),/*#__PURE__*/React.createElement(Grid,{item:true,xs:12},/*#__PURE__*/React.createElement(Field,{as:TextField,variant:\"outlined\",fullWidth:true,id:\"phone\",label:i18n.t(\"signup.form.phone\"),name:\"phone\",autoComplete:\"phone\"})),/*#__PURE__*/React.createElement(Grid,{item:true,xs:12},/*#__PURE__*/React.createElement(InputLabel,{htmlFor:\"plan-selection\"},\"Plano\"),/*#__PURE__*/React.createElement(Field,{as:Select,variant:\"outlined\",fullWidth:true,id:\"plan-selection\",label:\"Plano\",name:\"planId\",required:true},plans.map((plan,key)=>/*#__PURE__*/React.createElement(MenuItem,{key:key,value:plan.id},plan.name,\" - Atendentes: \",plan.users,\" - WhatsApp: \",plan.connections,\" - Filas: \",plan.queues,\" - R$ \",plan.amount))))),/*#__PURE__*/React.createElement(Button,{type:\"submit\",fullWidth:true,variant:\"contained\",color:\"primary\",className:classes.submit},i18n.t(\"signup.buttons.submit\")),/*#__PURE__*/React.createElement(Grid,{container:true},/*#__PURE__*/React.createElement(Grid,{item:true},/*#__PURE__*/React.createElement(Link,{href:\"#\",variant:\"body2\",component:RouterLink,to:\"/login\"},i18n.t(\"signup.buttons.login\")))));})),/*#__PURE__*/React.createElement(Box,{mt:5}))),/*#__PURE__*/React.createElement(\"div\",{className:classes.leftSide}));};export default SignUp;","map":null,"metadata":{},"sourceType":"module"}