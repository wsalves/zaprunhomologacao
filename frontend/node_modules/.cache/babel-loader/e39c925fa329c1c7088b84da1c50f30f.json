{"ast":null,"code":"import React,{useState,useEffect,useRef,useContext,Fragment}from\"react\";import*as Yup from\"yup\";import{Formik,FieldArray,Form,Field}from\"formik\";import{toast}from\"react-toastify\";import{FormControl,FormControlLabel,Grid,InputLabel,MenuItem,Paper,Select,Tab,Tabs}from\"@material-ui/core\";import{makeStyles}from\"@material-ui/core/styles\";import{green}from\"@material-ui/core/colors\";import Button from\"@material-ui/core/Button\";import TextField from\"@material-ui/core/TextField\";import Dialog from\"@material-ui/core/Dialog\";import DialogActions from\"@material-ui/core/DialogActions\";import DialogContent from\"@material-ui/core/DialogContent\";import DialogTitle from\"@material-ui/core/DialogTitle\";import CircularProgress from\"@material-ui/core/CircularProgress\";import SaveIcon from\"@material-ui/icons/Save\";import EditIcon from\"@material-ui/icons/Edit\";import HelpOutlineOutlinedIcon from\"@material-ui/icons/HelpOutlineOutlined\";import{i18n}from\"../../translate/i18n\";import Switch from\"@material-ui/core/Switch\";import{isArray}from\"lodash\";import api from\"../../services/api\";import toastError from\"../../errors/toastError\";import ColorPicker from\"../ColorPicker\";import{IconButton,InputAdornment}from\"@material-ui/core\";import{Colorize}from\"@material-ui/icons\";import Typography from\"@material-ui/core/Typography\";import DeleteOutline from\"@material-ui/icons/DeleteOutline\";import Stepper from\"@material-ui/core/Stepper\";import Step from\"@material-ui/core/Step\";import StepLabel from\"@material-ui/core/StepLabel\";import StepContent from\"@material-ui/core/StepContent\";import ConfirmationModal from\"../ConfirmationModal\";import Checkbox from'@mui/material/Checkbox';import OptionsChatBot from\"../ChatBots/options\";import CustomToolTip from\"../ToolTips\";import SchedulesForm from\"../SchedulesForm\";import useCompanySettings from\"../../hooks/useSettings/companySettings\";import{AuthContext}from\"../../context/Auth/AuthContext\";import Autocomplete,{createFilterOptions}from\"@material-ui/lab/Autocomplete\";import useQueues from\"../../hooks/useQueues\";import UserStatusIcon from\"../UserModal/statusIcon\";import usePlans from\"../../hooks/usePlans\";import ColorBoxModal from\"../ColorBoxModal\";// import { ColorBox } from \"material-ui-color\";\nconst useStyles=makeStyles(theme=>({root:{display:\"flex\",flexWrap:\"wrap\"},textField:{marginRight:theme.spacing(1),flex:1},textField1:{margin:theme.spacing(1),minWidth:120},btnWrapper:{position:\"relative\"},buttonProgress:{color:green[500],position:\"absolute\",top:\"50%\",left:\"50%\",marginTop:-12,marginLeft:-12},formControl:{margin:theme.spacing(1),minWidth:120},colorAdorment:{width:20,height:20},greetingMessage:{cursor:\"pointer\",display:\"flex\",alignItems:\"center\",\"& > *:not(:last-child)\":{marginRight:theme.spacing(1)}},custom:{display:\"flex\",alignItems:\"center\",justifyContent:\"center\"}}));const QueueSchema=Yup.object().shape({name:Yup.string().min(2,\"Too Short!\").max(50,\"Too Long!\").required(\"Required\"),color:Yup.string().min(3,\"Too Short!\").max(9,\"Too Long!\").required(),greetingMessage:Yup.string(),chatbots:Yup.array().of(Yup.object().shape({name:Yup.string().min(4,\"too short\").required(\"Required\")})).required(\"Must have friends\")});const QueueModal=_ref=>{let{open,onClose,queueId,onEdit}=_ref;const classes=useStyles();const initialState={name:\"\",color:\"\",greetingMessage:\"\",chatbots:[],outOfHoursMessage:\"\",orderQueue:\"\",tempoRoteador:0,ativarRoteador:false,integrationId:\"\",fileListId:\"\",closeTicket:false};const[colorPickerModalOpen,setColorPickerModalOpen]=useState(false);const[queue,setQueue]=useState(initialState);const greetingRef=useRef();const[activeStep,setActiveStep]=useState(null);const[selectedQueue,setSelectedQueue]=useState(null);const[confirmModalOpen,setConfirmModalOpen]=useState(false);const[isStepContent,setIsStepContent]=useState(true);const[isNameEdit,setIsNamedEdit]=useState(null);const[isGreetingMessageEdit,setGreetingMessageEdit]=useState(null);const[queues,setQueues]=useState([]);const[integrations,setIntegrations]=useState([]);const[schedulesEnabled,setSchedulesEnabled]=useState(false);const[tab,setTab]=useState(0);const[file,setFile]=useState(null);const{user,socket}=useContext(AuthContext);const[searchParam,setSearchParam]=useState(\"\");const[loading,setLoading]=useState(false);const[selectedQueueOption,setSelectedQueueOption]=useState(\"\");const{findAll:findAllQueues}=useQueues();const[allQueues,setAllQueues]=useState([]);const[userOptions,setUserOptions]=useState([]);const isMounted=useRef(true);const initialStateSchedule=[{weekday:i18n.t(\"queueModal.serviceHours.monday\"),weekdayEn:\"monday\",startTimeA:\"08:00\",endTimeA:\"12:00\",startTimeB:\"13:00\",endTimeB:\"18:00\"},{weekday:i18n.t(\"queueModal.serviceHours.tuesday\"),weekdayEn:\"tuesday\",startTimeA:\"08:00\",endTimeA:\"12:00\",startTimeB:\"13:00\",endTimeB:\"18:00\"},{weekday:i18n.t(\"queueModal.serviceHours.wednesday\"),weekdayEn:\"wednesday\",startTimeA:\"08:00\",endTimeA:\"12:00\",startTimeB:\"13:00\",endTimeB:\"18:00\"},{weekday:i18n.t(\"queueModal.serviceHours.thursday\"),weekdayEn:\"thursday\",startTimeA:\"08:00\",endTimeA:\"12:00\",startTimeB:\"13:00\",endTimeB:\"18:00\"},{weekday:i18n.t(\"queueModal.serviceHours.friday\"),weekdayEn:\"friday\",startTimeA:\"08:00\",endTimeA:\"12:00\",startTimeB:\"13:00\",endTimeB:\"18:00\"},{weekday:\"Sábado\",weekdayEn:\"saturday\",startTimeA:\"08:00\",endTimeA:\"12:00\",startTimeB:\"13:00\",endTimeB:\"18:00\"},{weekday:\"Domingo\",weekdayEn:\"sunday\",startTimeA:\"08:00\",endTimeA:\"12:00\",startTimeB:\"13:00\",endTimeB:\"18:00\"}];const[schedules,setSchedules]=useState(initialStateSchedule);const companyId=user.companyId;const{get:getSetting}=useCompanySettings();const[showOpenAi,setShowOpenAi]=useState(false);const[showIntegrations,setShowIntegrations]=useState(false);const{getPlanCompany}=usePlans();useEffect(()=>{async function fetchData(){const companyId=user.companyId;const planConfigs=await getPlanCompany(undefined,companyId);setShowOpenAi(planConfigs.plan.useOpenAi);setShowIntegrations(planConfigs.plan.useIntegrations);}fetchData();// eslint-disable-next-line react-hooks/exhaustive-deps\n},[]);useEffect(()=>{const fetchData=async()=>{const setting=await getSetting({\"column\":\"scheduleType\"});if(setting.scheduleType===\"queue\")setSchedulesEnabled(true);};fetchData();},[]);useEffect(()=>{(async()=>{try{const{data}=await api.get(\"/files/\",{params:{companyId}});setFile(data.files);}catch(err){toastError(err);}})();},[]);useEffect(()=>{(async()=>{if(!queueId)return;try{const{data}=await api.get(\"/queue/\".concat(queueId));setQueue(prevState=>{return{...prevState,...data};});if(isArray(data.schedules)&&data.schedules.length>0)setSchedules(data.schedules);}catch(err){toastError(err);}})();return()=>{setQueue({name:\"\",color:\"\",greetingMessage:\"\",chatbots:[],outOfHoursMessage:\"\",orderQueue:\"\",tempoRoteador:\"\",ativarRoteador:false,integrationId:\"\",fileListId:\"\",closeTicket:false});};},[queueId,open]);useEffect(()=>{if(isMounted.current){const loadQueues=async()=>{const list=await findAllQueues();setAllQueues(list);setQueues(list);};loadQueues();}// eslint-disable-next-line react-hooks/exhaustive-deps\n},[]);useEffect(()=>{if(searchParam.length<3){setLoading(false);setSelectedQueueOption(\"\");return;}const delayDebounceFn=setTimeout(()=>{//setLoading(true);\nconst fetchUsers=async()=>{try{const{data}=await api.get(\"/users/\");setUserOptions(data.users);setLoading(false);}catch(err){setLoading(false);toastError(err);}};fetchUsers();},500);return()=>clearTimeout(delayDebounceFn);},[searchParam]);useEffect(()=>{(async()=>{try{const{data}=await api.get(\"/queueIntegration\");setIntegrations(data.queueIntegrations);}catch(err){toastError(err);}})();},[]);useEffect(()=>{if(activeStep){var _queue$chatbots$activ;setSelectedQueueOption((_queue$chatbots$activ=queue.chatbots[activeStep])===null||_queue$chatbots$activ===void 0?void 0:_queue$chatbots$activ.optQueueId);}if(activeStep===isNameEdit){setIsStepContent(false);}else{setIsStepContent(true);}},[isNameEdit,activeStep]);const handleClose=()=>{onClose();setIsNamedEdit(null);setActiveStep(null);setGreetingMessageEdit(null);};const handleSaveSchedules=async values=>{toast.success(\"Clique em salvar para registar as alterações\");setSchedules(values);setTab(0);};const filterOptions=createFilterOptions({trim:true});const handleCloseConfirmationModal=()=>{setConfirmModalOpen(false);setSelectedQueue(null);};const handleDeleteQueue=async optionsId=>{try{await api.delete(\"/chatbot/\".concat(optionsId));const{data}=await api.get(\"/queue/\".concat(queueId));setQueue(initialState);setQueue(data);setIsNamedEdit(null);setGreetingMessageEdit(null);toast.success(\"\".concat(i18n.t(\"queues.toasts.deleted\")));}catch(err){toastError(err);}};const handleSaveQueue=async values=>{try{if(queueId){await api.put(\"/queue/\".concat(queueId),{...values,schedules});}else{await api.post(\"/queue\",{...values,schedules});}toast.success(\"\".concat(i18n.t(\"queues.toasts.success\")));handleClose();}catch(err){toastError(err);}};const handleSaveBot=async values=>{try{if(queueId){const{data}=await api.put(\"/queue/\".concat(queueId),values);if(data.chatbots&&data.chatbots.length){onEdit(data);setQueue(data);}}else{const{data}=await api.post(\"/queue\",values);if(data.chatbots&&data.chatbots.length){setQueue(data);onEdit(data);handleClose();}}setIsNamedEdit(null);setGreetingMessageEdit(null);toast.success(\"\".concat(i18n.t(\"queues.toasts.success\")));}catch(err){toastError(err);}};// const renderColorBox = (open, handleClose, color, handleColorChange) => {\n//   return (\n//     <Dialog open={open} onClose={handleClose}>\n//       <DialogTitle>Escolha uma cor</DialogTitle>\n//       <DialogContent>\n//         <ColorBox\n//           disableAlpha={true}\n//           hslGradient={false}\n//           style={{ margin: '20px auto 0' }}\n//           value={color}\n//           onChange={handleColorChange} />\n//       </DialogContent>\n//       <DialogActions>\n//         <Button onClick={handleClose} color=\"primary\">\n//           Cancelar\n//         </Button>\n//         <Button\n//           color=\"primary\"\n//           variant=\"contained\"\n//           className={classes.btnWrapper}\n//           onClick={handleClose} >\n//           OK\n//         </Button>\n//       </DialogActions>\n//     </Dialog>\n//   )\n// }\nreturn/*#__PURE__*/React.createElement(\"div\",{className:classes.root},/*#__PURE__*/React.createElement(ConfirmationModal,{title:selectedQueue&&\"\".concat(i18n.t(\"queues.confirmationModal.deleteTitle\"),\" \").concat(selectedQueue.name,\"?\"),open:confirmModalOpen,onClose:handleCloseConfirmationModal,onConfirm:()=>handleDeleteQueue(selectedQueue.id)},i18n.t(\"queueModal.title.confirmationDelete\")),/*#__PURE__*/React.createElement(Dialog,{maxWidth:\"md\",fullWidth:true,open:open,onClose:handleClose,scroll:\"paper\"},/*#__PURE__*/React.createElement(DialogTitle,null,queueId?\"\".concat(i18n.t(\"queueModal.title.edit\")):\"\".concat(i18n.t(\"queueModal.title.add\"))),/*#__PURE__*/React.createElement(Tabs,{value:tab,indicatorColor:\"primary\",textColor:\"primary\",onChange:(e,v)=>setTab(v),\"aria-label\":\"disabled tabs example\"},/*#__PURE__*/React.createElement(Tab,{label:i18n.t(\"queueModal.title.queueData\")}),schedulesEnabled&&/*#__PURE__*/React.createElement(Tab,{label:i18n.t(\"queueModal.title.text\")})),tab===0&&/*#__PURE__*/React.createElement(Formik,{initialValues:queue,validateOnChange:false,enableReinitialize:true,validationSchema:QueueSchema,onSubmit:(values,actions)=>{setTimeout(()=>{handleSaveQueue(values);actions.setSubmitting(false);},400);}},_ref2=>{let{setFieldValue,touched,errors,isSubmitting,values}=_ref2;return/*#__PURE__*/React.createElement(Form,null,/*#__PURE__*/React.createElement(DialogContent,{dividers:true},/*#__PURE__*/React.createElement(Field,{as:TextField,label:i18n.t(\"queueModal.form.name\"),autoFocus:true,name:\"name\",error:touched.name&&Boolean(errors.name),helperText:touched.name&&errors.name,variant:\"outlined\",margin:\"dense\",className:classes.textField}),/*#__PURE__*/React.createElement(Field,{as:TextField,label:i18n.t(\"queueModal.form.color\"),name:\"color\",id:\"color\",onFocus:()=>{setColorPickerModalOpen(true);greetingRef.current.focus();},error:touched.color&&Boolean(errors.color),helperText:touched.color&&errors.color,InputProps:{startAdornment:/*#__PURE__*/React.createElement(InputAdornment,{position:\"start\"},/*#__PURE__*/React.createElement(\"div\",{style:{backgroundColor:values.color},className:classes.colorAdorment})),endAdornment:/*#__PURE__*/React.createElement(IconButton,{size:\"small\",color:\"default\",onClick:()=>setColorPickerModalOpen(!colorPickerModalOpen)},/*#__PURE__*/React.createElement(Colorize,null))},variant:\"outlined\",margin:\"dense\"}),/*#__PURE__*/React.createElement(ColorBoxModal,{open:colorPickerModalOpen,handleClose:()=>setColorPickerModalOpen(false),onChange:color=>{setFieldValue(\"color\",\"#\".concat(color.hex));},currentColor:values.color}),/*#__PURE__*/React.createElement(Field,{as:TextField,label:i18n.t(\"queueModal.form.orderQueue\"),name:\"orderQueue\",type:\"orderQueue\",error:touched.orderQueue&&Boolean(errors.orderQueue),helperText:touched.orderQueue&&errors.orderQueue,variant:\"outlined\",margin:\"dense\",className:classes.textField1}),/*#__PURE__*/React.createElement(FormControlLabel,{control:/*#__PURE__*/React.createElement(Field,{as:Switch,color:\"primary\",name:\"closeTicket\",checked:values.closeTicket}),label:i18n.t(\"queueModal.form.closeTicket\")}),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(FormControlLabel,{control:/*#__PURE__*/React.createElement(Field,{as:Switch,color:\"primary\",name:\"ativarRoteador\",checked:values.ativarRoteador}),label:i18n.t(\"queueModal.form.rotate\")}),/*#__PURE__*/React.createElement(Field,{as:Select,label:i18n.t(\"queueModal.form.timeRotate\"),name:\"tempoRoteador\",id:\"tempoRoteador\",variant:\"outlined\",margin:\"dense\",className:classes.selectField},/*#__PURE__*/React.createElement(MenuItem,{value:\"0\",selected:true,disabled:true},i18n.t(\"queueModal.form.timeRotate\")),/*#__PURE__*/React.createElement(MenuItem,{value:\"2\"},\"2 minutos\"),/*#__PURE__*/React.createElement(MenuItem,{value:\"5\"},\"5 minutos\"),/*#__PURE__*/React.createElement(MenuItem,{value:\"10\"},\"10 minutos\"),/*#__PURE__*/React.createElement(MenuItem,{value:\"15\"},\"15 minutos\"),/*#__PURE__*/React.createElement(MenuItem,{value:\"30\"},\"30 minutos\"),/*#__PURE__*/React.createElement(MenuItem,{value:\"45\"},\"45 minutos\"),/*#__PURE__*/React.createElement(MenuItem,{value:\"60\"},\"60 minutos\"))),/*#__PURE__*/React.createElement(\"div\",null,showIntegrations&&/*#__PURE__*/React.createElement(FormControl,{variant:\"outlined\",margin:\"dense\",className:classes.FormControl,fullWidth:true},/*#__PURE__*/React.createElement(InputLabel,{id:\"integrationId-selection-label\"},i18n.t(\"queueModal.form.integrationId\")),/*#__PURE__*/React.createElement(Field,{as:Select,label:i18n.t(\"queueModal.form.integrationId\"),name:\"integrationId\",id:\"integrationId\",placeholder:i18n.t(\"queueModal.form.integrationId\"),labelId:\"integrationId-selection-label\",value:values.integrationId||\"\"},/*#__PURE__*/React.createElement(MenuItem,{value:\"\"},\"Nenhum\"),integrations.map(integration=>/*#__PURE__*/React.createElement(MenuItem,{key:integration.id,value:integration.id},integration.name)))),/*#__PURE__*/React.createElement(FormControl,{variant:\"outlined\",margin:\"dense\",className:classes.FormControl,fullWidth:true},/*#__PURE__*/React.createElement(InputLabel,{id:\"fileListId-selection-label\"},i18n.t(\"queueModal.form.fileListId\")),/*#__PURE__*/React.createElement(Field,{as:Select,label:i18n.t(\"queueModal.form.fileListId\"),name:\"fileListId\",id:\"fileListId\",placeholder:i18n.t(\"queueModal.form.fileListId\"),labelId:\"fileListId-selection-label\",value:values.fileListId||\"\"},/*#__PURE__*/React.createElement(MenuItem,{value:\"\"},\"Nenhum\"),file.map(f=>/*#__PURE__*/React.createElement(MenuItem,{key:f.id,value:f.id},f.name))))),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Field,{as:TextField,label:i18n.t(\"queueModal.form.greetingMessage\"),type:\"greetingMessage\",multiline:true,inputRef:greetingRef,minRows:5,fullWidth:true,name:\"greetingMessage\",error:touched.greetingMessage&&Boolean(errors.greetingMessage),helperText:touched.greetingMessage&&errors.greetingMessage,variant:\"outlined\",margin:\"dense\"}),schedulesEnabled&&/*#__PURE__*/React.createElement(Field,{as:TextField,label:i18n.t(\"queueModal.form.outOfHoursMessage\"),type:\"outOfHoursMessage\",multiline:true,rows:5,fullWidth:true,required:schedulesEnabled,name:\"outOfHoursMessage\",error:touched.outOfHoursMessage&&Boolean(errors.outOfHoursMessage),helperText:touched.outOfHoursMessage&&errors.outOfHoursMessage,variant:\"outlined\",margin:\"dense\"})),/*#__PURE__*/React.createElement(Typography,{variant:\"subtitle1\"},i18n.t(\"queueModal.bot.title\"),/*#__PURE__*/React.createElement(CustomToolTip,{title:i18n.t(\"queueModal.bot.toolTipTitle\"),content:i18n.t(\"queueModal.bot.toolTip\")},/*#__PURE__*/React.createElement(HelpOutlineOutlinedIcon,{style:{marginLeft:\"14px\"},fontSize:\"small\"}))),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(FieldArray,{name:\"chatbots\"},_ref3=>{let{push,remove}=_ref3;return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Stepper,{nonLinear:true,activeStep:activeStep,orientation:\"vertical\"},values.chatbots&&values.chatbots.length>0&&values.chatbots.map((info,index)=>{var _queue$chatbots$index,_touched$chatbots,_touched$chatbots$ind,_errors$chatbots,_errors$chatbots$inde,_touched$chatbots2,_touched$chatbots2$in,_errors$chatbots2,_errors$chatbots2$ind,_queue$chatbots$index2,_touched$chatbots3,_touched$chatbots3$in,_errors$chatbots3,_errors$chatbots3$ind,_touched$chatbots4,_touched$chatbots4$in,_errors$chatbots4,_errors$chatbots4$ind,_touched$chatbots5,_touched$chatbots5$in,_errors$chatbots5,_errors$chatbots5$ind,_touched$chatbots6,_touched$chatbots6$in,_errors$chatbots6,_errors$chatbots6$ind,_touched$chatbots7,_touched$chatbots7$in,_errors$chatbots7,_errors$chatbots7$ind,_touched$chatbots8,_touched$chatbots8$in,_errors$chatbots8,_errors$chatbots8$ind;return/*#__PURE__*/React.createElement(Step,{key:\"\".concat(info.id?info.id:index,\"-chatbots\"),onClick:()=>setActiveStep(index)},/*#__PURE__*/React.createElement(StepLabel,{key:\"\".concat(info.id,\"-chatbots\")},isNameEdit!==index&&((_queue$chatbots$index=queue.chatbots[index])===null||_queue$chatbots$index===void 0?void 0:_queue$chatbots$index.name)?/*#__PURE__*/React.createElement(\"div\",{className:classes.greetingMessage,variant:\"body1\"},values.chatbots[index].name,/*#__PURE__*/React.createElement(IconButton,{size:\"small\",onClick:()=>{setIsNamedEdit(index);setIsStepContent(false);}},/*#__PURE__*/React.createElement(EditIcon,null)),/*#__PURE__*/React.createElement(IconButton,{onClick:()=>{setSelectedQueue(info);setConfirmModalOpen(true);},size:\"small\"},/*#__PURE__*/React.createElement(DeleteOutline,null))):/*#__PURE__*/React.createElement(Grid,{spacing:2,container:true},/*#__PURE__*/React.createElement(Grid,{xs:12,md:12,item:true},/*#__PURE__*/React.createElement(Field,{as:TextField,name:\"chatbots[\".concat(index,\"].name\"),variant:\"outlined\",margin:\"dense\",color:\"primary\",label:i18n.t(\"queueModal.form.greetingMessage\"),disabled:isSubmitting,autoFocus:true,fullWidth:true,size:\"small\",error:(touched===null||touched===void 0?void 0:(_touched$chatbots=touched.chatbots)===null||_touched$chatbots===void 0?void 0:(_touched$chatbots$ind=_touched$chatbots[index])===null||_touched$chatbots$ind===void 0?void 0:_touched$chatbots$ind.name)&&Boolean((_errors$chatbots=errors.chatbots)===null||_errors$chatbots===void 0?void 0:(_errors$chatbots$inde=_errors$chatbots[index])===null||_errors$chatbots$inde===void 0?void 0:_errors$chatbots$inde.name),className:classes.textField})),/*#__PURE__*/React.createElement(Grid,{xs:12,md:8,item:true},/*#__PURE__*/React.createElement(FormControl,{variant:\"outlined\",margin:\"dense\",className:classes.formControl,fullWidth:true},/*#__PURE__*/React.createElement(InputLabel,{id:\"queueType-selection-label\"},i18n.t(\"queueModal.form.queueType\")),/*#__PURE__*/React.createElement(Field,{as:Select,name:\"chatbots[\".concat(index,\"].queueType\"),variant:\"outlined\",margin:\"dense\",fullWidth:true,labelId:\"queueType-selection-label\",label:i18n.t(\"queueModal.form.queueType\"),error:(touched===null||touched===void 0?void 0:(_touched$chatbots2=touched.chatbots)===null||_touched$chatbots2===void 0?void 0:(_touched$chatbots2$in=_touched$chatbots2[index])===null||_touched$chatbots2$in===void 0?void 0:_touched$chatbots2$in.queueType)&&Boolean(errors===null||errors===void 0?void 0:(_errors$chatbots2=errors.chatbots)===null||_errors$chatbots2===void 0?void 0:(_errors$chatbots2$ind=_errors$chatbots2[index])===null||_errors$chatbots2$ind===void 0?void 0:_errors$chatbots2$ind.queueType)// helpertext={touched?.chatbots?.[index]?.queueType && errors?.chatbots?.[index]?.queueType}\n// value={`chatbots[${index}].queueType`}\n},/*#__PURE__*/React.createElement(MenuItem,{value:\"text\"},i18n.t(\"queueModal.bot.text\")),/*#__PURE__*/React.createElement(MenuItem,{value:\"attendent\"},i18n.t(\"queueModal.bot.attendent\")),/*#__PURE__*/React.createElement(MenuItem,{value:\"queue\"},i18n.t(\"queueModal.bot.queue\")),/*#__PURE__*/React.createElement(MenuItem,{value:\"integration\"},i18n.t(\"queueModal.bot.integration\")),/*#__PURE__*/React.createElement(MenuItem,{value:\"file\"},i18n.t(\"queueModal.bot.file\"))))),/*#__PURE__*/React.createElement(Grid,{xs:12,md:4,item:true},/*#__PURE__*/React.createElement(FormControlLabel,{control:/*#__PURE__*/React.createElement(Field,{as:Checkbox,color:\"primary\",name:\"chatbots[\".concat(index,\"].closeTicket\"),checked:values.chatbots[index].closeTicket||false}),labelPlacement:\"top\",label:i18n.t(\"queueModal.form.closeTicket\")}),/*#__PURE__*/React.createElement(IconButton,{size:\"small\",onClick:()=>values.chatbots[index].name?handleSaveBot(values):null,disabled:isSubmitting},/*#__PURE__*/React.createElement(SaveIcon,null)),/*#__PURE__*/React.createElement(IconButton,{size:\"small\",onClick:()=>remove(index),disabled:isSubmitting},/*#__PURE__*/React.createElement(DeleteOutline,null))))),isStepContent&&queue.chatbots[index]&&/*#__PURE__*/React.createElement(StepContent,null,/*#__PURE__*/React.createElement(React.Fragment,null,isGreetingMessageEdit!==index?/*#__PURE__*/React.createElement(\"div\",{className:classes.greetingMessage},/*#__PURE__*/React.createElement(Typography,{color:\"textSecondary\",variant:\"body1\"},\"Message:\"),values.chatbots[index].greetingMessage,!((_queue$chatbots$index2=queue.chatbots[index])===null||_queue$chatbots$index2===void 0?void 0:_queue$chatbots$index2.greetingMessage)&&/*#__PURE__*/React.createElement(CustomToolTip,{title:i18n.t(\"queueModal.bot.toolTipMessageTitle\"),content:i18n.t(\"queueModal.bot.toolTipMessageContent\")},/*#__PURE__*/React.createElement(HelpOutlineOutlinedIcon,{color:\"secondary\",style:{marginLeft:\"4px\"},fontSize:\"small\"})),/*#__PURE__*/React.createElement(IconButton,{size:\"small\",onClick:()=>setGreetingMessageEdit(index)},/*#__PURE__*/React.createElement(EditIcon,null))):/*#__PURE__*/React.createElement(Grid,{spacing:2,container:true},/*#__PURE__*/React.createElement(\"div\",{className:classes.greetingMessage},queue.chatbots[index].queueType===\"text\"&&/*#__PURE__*/React.createElement(Grid,{xs:12,md:12,item:true},/*#__PURE__*/React.createElement(Field,{as:TextField,name:\"chatbots[\".concat(index,\"].greetingMessage\"),label:i18n.t(\"queueModal.form.message\"),variant:\"outlined\",margin:\"dense\",fullWidth:true,multiline:true,error:touched.greetingMessage&&Boolean(errors.greetingMessage),helperText:touched.greetingMessage&&errors.greetingMessage,className:classes.textField}))),queue.chatbots[index].queueType===\"queue\"&&/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Grid,{xs:12,md:12,item:true},/*#__PURE__*/React.createElement(Field,{as:TextField,name:\"chatbots[\".concat(index,\"].greetingMessage\"),label:i18n.t(\"queueModal.form.message\"),variant:\"outlined\",margin:\"dense\",fullWidth:true,multiline:true,error:touched.greetingMessage&&Boolean(errors.greetingMessage),helperText:touched.greetingMessage&&errors.greetingMessage,className:classes.textField})),/*#__PURE__*/React.createElement(Grid,{xs:12,md:8,item:true},/*#__PURE__*/React.createElement(FormControl,{variant:\"outlined\",margin:\"dense\",className:classes.FormControl,fullWidth:true},/*#__PURE__*/React.createElement(InputLabel,{id:\"queue-selection-label\"},i18n.t(\"queueModal.form.queue\")),/*#__PURE__*/React.createElement(Field,{as:Select,name:\"chatbots[\".concat(index,\"].optQueueId\"),error:(touched===null||touched===void 0?void 0:(_touched$chatbots3=touched.chatbots)===null||_touched$chatbots3===void 0?void 0:(_touched$chatbots3$in=_touched$chatbots3[index])===null||_touched$chatbots3$in===void 0?void 0:_touched$chatbots3$in.optQueueId)&&Boolean(errors===null||errors===void 0?void 0:(_errors$chatbots3=errors.chatbots)===null||_errors$chatbots3===void 0?void 0:(_errors$chatbots3$ind=_errors$chatbots3[index])===null||_errors$chatbots3$ind===void 0?void 0:_errors$chatbots3$ind.optQueueId),helpertext:(touched===null||touched===void 0?void 0:(_touched$chatbots4=touched.chatbots)===null||_touched$chatbots4===void 0?void 0:(_touched$chatbots4$in=_touched$chatbots4[index])===null||_touched$chatbots4$in===void 0?void 0:_touched$chatbots4$in.optQueueId)&&(errors===null||errors===void 0?void 0:(_errors$chatbots4=errors.chatbots)===null||_errors$chatbots4===void 0?void 0:(_errors$chatbots4$ind=_errors$chatbots4[index])===null||_errors$chatbots4$ind===void 0?void 0:_errors$chatbots4$ind.optQueueId)// value={`chatbots[${index}].optQueueId`}\n,className:classes.textField1},queues.map(queue=>/*#__PURE__*/React.createElement(MenuItem,{key:queue.id,value:queue.id},queue.name)))))),queue.chatbots[index].queueType===\"attendent\"&&/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Grid,{xs:12,md:12,item:true},/*#__PURE__*/React.createElement(Field,{as:TextField,name:\"chatbots[\".concat(index,\"].greetingMessage\"),label:i18n.t(\"queueModal.form.message\"),variant:\"outlined\",margin:\"dense\",fullWidth:true,multiline:true,error:touched.greetingMessage&&Boolean(errors.greetingMessage),helperText:touched.greetingMessage&&errors.greetingMessage,className:classes.textField})),/*#__PURE__*/React.createElement(Grid,{xs:12,md:4,item:true},/*#__PURE__*/React.createElement(Autocomplete,{style:{marginTop:'8px'},variant:\"outlined\",margin:\"dense\",getOptionLabel:option=>\"\".concat(option.name),value:queue.chatbots[index].user,onChange:(e,newValue)=>{if(newValue!=null){setFieldValue(\"chatbots[\".concat(index,\"].optUserId\"),newValue.id);}else{setFieldValue(\"chatbots[\".concat(index,\"].optUserId\"),null);}if(newValue!=null&&Array.isArray(newValue.queues)){if(newValue.queues.length===1){setSelectedQueueOption(newValue.queues[0].id);setFieldValue(\"chatbots[\".concat(index,\"].optQueueId\"),newValue.queues[0].id);}setQueues(newValue.queues);}else{setQueues(allQueues);setSelectedQueueOption(\"\");}},options:userOptions,filterOptions:filterOptions,freeSolo:true,fullWidth:true,autoHighlight:true,noOptionsText:i18n.t(\"transferTicketModal.noOptions\"),loading:loading,size:\"small\",renderOption:option=>/*#__PURE__*/React.createElement(\"span\",null,\" \",/*#__PURE__*/React.createElement(UserStatusIcon,{user:option}),\" \",option.name),renderInput:params=>/*#__PURE__*/React.createElement(TextField,Object.assign({},params,{label:i18n.t(\"transferTicketModal.fieldLabel\"),variant:\"outlined\",onChange:e=>setSearchParam(e.target.value),InputProps:{...params.InputProps,endAdornment:/*#__PURE__*/React.createElement(Fragment,null,loading?/*#__PURE__*/React.createElement(CircularProgress,{color:\"inherit\",size:20}):null,params.InputProps.endAdornment)}}))})),/*#__PURE__*/React.createElement(Grid,{xs:12,md:4,item:true},/*#__PURE__*/React.createElement(FormControl,{variant:\"outlined\",margin:\"dense\",fullWidth:true,className:classes.formControl},/*#__PURE__*/React.createElement(InputLabel,null,i18n.t(\"transferTicketModal.fieldQueueLabel\")),/*#__PURE__*/React.createElement(Select,{value:selectedQueueOption,onChange:e=>{setSelectedQueueOption(e.target.value);setFieldValue(\"chatbots[\".concat(index,\"].optQueueId\"),e.target.value);},label:i18n.t(\"transferTicketModal.fieldQueuePlaceholder\")},queues.map(queue=>/*#__PURE__*/React.createElement(MenuItem,{key:queue.id,value:queue.id},queue.name)))))),queue.chatbots[index].queueType===\"integration\"&&/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Grid,{xs:12,md:12,item:true},/*#__PURE__*/React.createElement(Field,{as:TextField,name:\"chatbots[\".concat(index,\"].greetingMessage\"),label:i18n.t(\"queueModal.form.message\"),variant:\"outlined\",margin:\"dense\",fullWidth:true,multiline:true,error:touched.greetingMessage&&Boolean(errors.greetingMessage),helperText:touched.greetingMessage&&errors.greetingMessage,className:classes.textField})),/*#__PURE__*/React.createElement(Grid,{xs:12,md:8,item:true},/*#__PURE__*/React.createElement(FormControl,{variant:\"outlined\",margin:\"dense\",className:classes.FormControl,fullWidth:true},/*#__PURE__*/React.createElement(InputLabel,{id:\"optIntegrationId-selection-label\"},i18n.t(\"queueModal.form.integration\")),/*#__PURE__*/React.createElement(Field,{as:Select,name:\"chatbots[\".concat(index,\"].optIntegrationId\"),error:(touched===null||touched===void 0?void 0:(_touched$chatbots5=touched.chatbots)===null||_touched$chatbots5===void 0?void 0:(_touched$chatbots5$in=_touched$chatbots5[index])===null||_touched$chatbots5$in===void 0?void 0:_touched$chatbots5$in.optIntegrationId)&&Boolean(errors===null||errors===void 0?void 0:(_errors$chatbots5=errors.chatbots)===null||_errors$chatbots5===void 0?void 0:(_errors$chatbots5$ind=_errors$chatbots5[index])===null||_errors$chatbots5$ind===void 0?void 0:_errors$chatbots5$ind.optIntegrationId),helpertext:(touched===null||touched===void 0?void 0:(_touched$chatbots6=touched.chatbots)===null||_touched$chatbots6===void 0?void 0:(_touched$chatbots6$in=_touched$chatbots6[index])===null||_touched$chatbots6$in===void 0?void 0:_touched$chatbots6$in.optIntegrationId)&&(errors===null||errors===void 0?void 0:(_errors$chatbots6=errors.chatbots)===null||_errors$chatbots6===void 0?void 0:(_errors$chatbots6$ind=_errors$chatbots6[index])===null||_errors$chatbots6$ind===void 0?void 0:_errors$chatbots6$ind.optIntegrationId)// value={`chatbots[${index}].optQueueId`}\n,className:classes.textField1},integrations.map(integration=>/*#__PURE__*/React.createElement(MenuItem,{key:integration.id,value:integration.id},integration.name)))))),queue.chatbots[index].queueType===\"file\"&&/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Grid,{xs:12,md:12,item:true},/*#__PURE__*/React.createElement(Field,{as:TextField,name:\"chatbots[\".concat(index,\"].greetingMessage\"),label:i18n.t(\"queueModal.form.message\"),variant:\"outlined\",margin:\"dense\",fullWidth:true,multiline:true,error:touched.greetingMessage&&Boolean(errors.greetingMessage),helperText:touched.greetingMessage&&errors.greetingMessage,className:classes.textField})),/*#__PURE__*/React.createElement(InputLabel,null,\"Selecione um Arquivo\"),/*#__PURE__*/React.createElement(Field,{as:Select,name:\"chatbots[\".concat(index,\"].optFileId\"),error:(touched===null||touched===void 0?void 0:(_touched$chatbots7=touched.chatbots)===null||_touched$chatbots7===void 0?void 0:(_touched$chatbots7$in=_touched$chatbots7[index])===null||_touched$chatbots7$in===void 0?void 0:_touched$chatbots7$in.optFileId)&&Boolean(errors===null||errors===void 0?void 0:(_errors$chatbots7=errors.chatbots)===null||_errors$chatbots7===void 0?void 0:(_errors$chatbots7$ind=_errors$chatbots7[index])===null||_errors$chatbots7$ind===void 0?void 0:_errors$chatbots7$ind.optFileId),helpertext:(touched===null||touched===void 0?void 0:(_touched$chatbots8=touched.chatbots)===null||_touched$chatbots8===void 0?void 0:(_touched$chatbots8$in=_touched$chatbots8[index])===null||_touched$chatbots8$in===void 0?void 0:_touched$chatbots8$in.optFileId)&&(errors===null||errors===void 0?void 0:(_errors$chatbots8=errors.chatbots)===null||_errors$chatbots8===void 0?void 0:(_errors$chatbots8$ind=_errors$chatbots8[index])===null||_errors$chatbots8$ind===void 0?void 0:_errors$chatbots8$ind.optFileId),className:classes.textField1},file.map(f=>/*#__PURE__*/React.createElement(MenuItem,{key:f.id,value:f.id},f.name)))),/*#__PURE__*/React.createElement(IconButton,{size:\"small\",onClick:()=>handleSaveBot(values),disabled:isSubmitting},\" \",/*#__PURE__*/React.createElement(SaveIcon,null))),/*#__PURE__*/React.createElement(OptionsChatBot,{chatBotId:info.id}))));}),/*#__PURE__*/React.createElement(Step,null,/*#__PURE__*/React.createElement(StepLabel,{onClick:()=>push({name:\"\",value:\"\"})},i18n.t(\"queueModal.bot.addOptions\")))));}))),/*#__PURE__*/React.createElement(DialogActions,null,/*#__PURE__*/React.createElement(Button,{onClick:handleClose// color=\"secondary\"\n,disabled:isSubmitting// variant=\"outlined\"\n},i18n.t(\"queueModal.buttons.cancel\")),/*#__PURE__*/React.createElement(Button,{type:\"submit\",color:\"primary\",disabled:isSubmitting,variant:\"contained\",className:classes.btnWrapper},queueId?\"\".concat(i18n.t(\"queueModal.buttons.okEdit\")):\"\".concat(i18n.t(\"queueModal.buttons.okAdd\")),isSubmitting&&/*#__PURE__*/React.createElement(CircularProgress,{size:24,className:classes.buttonProgress}))));}),tab===1&&/*#__PURE__*/React.createElement(Paper,{style:{padding:20}},/*#__PURE__*/React.createElement(SchedulesForm,{loading:false,onSubmit:handleSaveSchedules,initialValues:schedules,labelSaveButton:i18n.t(\"whatsappModal.buttons.okAdd\")}))));};export default QueueModal;","map":null,"metadata":{},"sourceType":"module"}