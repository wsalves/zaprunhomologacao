{"ast":null,"code":"import React,{useContext,useEffect,useState}from\"react\";import{makeStyles,Modal,Backdrop,Fade,Table,TableBody,TableCell,TableContainer,TableHead,TableRow,Paper,IconButton}from\"@material-ui/core\";import DeleteIcon from\"@material-ui/icons/Delete\";import CloseIcon from\"@material-ui/icons/Close\";import api from\"../../services/api\";import{AuthContext}from\"../../context/Auth/AuthContext\";const useStyles=makeStyles(theme=>({modal:{display:\"flex\",alignItems:\"center\",justifyContent:\"center\"},paper:{backgroundColor:theme.palette.background.paper,boxShadow:theme.shadows[5],padding:theme.spacing(2,4,3),borderRadius:\"8px\",overflow:\"auto\",maxHeight:\"80vh\"},closeButton:{position:\"absolute\",top:theme.spacing(1),right:theme.spacing(1)}}));const handleRemoveContactTag=async(contactId,tagId)=>{await api.delete(\"/tags-contacts/\".concat(tagId,\"/\").concat(contactId));};const ContactTagListModal=_ref=>{let{open,onClose,tag}=_ref;const classes=useStyles();const[tagList,setTagList]=useState(tag.contacts);const{user,socket}=useContext(AuthContext);useEffect(()=>{console.log(\"tagList\",tagList);},[tagList]);useEffect(()=>{// const socket = socketManager.GetSocket(user.companyId, user.id);\nconst onCompanyTags=data=>{if(data.action===\"update\"||data.action===\"create\"){var _data$tag,_data$tag$contacts,_data$tag2,_data$tag2$contacts;if(data.tag.id===tag.id&&((_data$tag=data.tag)===null||_data$tag===void 0?void 0:(_data$tag$contacts=_data$tag.contacts)===null||_data$tag$contacts===void 0?void 0:_data$tag$contacts.length)>0){setTagList(data.tag.contacts);}if(data.tag.id===tag.id&&((_data$tag2=data.tag)===null||_data$tag2===void 0?void 0:(_data$tag2$contacts=_data$tag2.contacts)===null||_data$tag2$contacts===void 0?void 0:_data$tag2$contacts.length)===0){setTagList([]);onClose();}}};socket.on(\"company\".concat(user.companyId,\"-tag\"),onCompanyTags);return()=>{socket.off(\"company\".concat(user.companyId,\"-tag\"),onCompanyTags);};},[]);// DependÃªncia do estado auxiliar updateFlag\nreturn tagList.length>0?/*#__PURE__*/React.createElement(Modal,{className:classes.modal,open:open,onClose:onClose,closeAfterTransition:true,BackdropComponent:Backdrop,BackdropProps:{timeout:500}},/*#__PURE__*/React.createElement(Fade,{in:open},/*#__PURE__*/React.createElement(\"div\",{className:classes.paper},/*#__PURE__*/React.createElement(IconButton,{className:classes.closeButton,onClick:onClose},/*#__PURE__*/React.createElement(CloseIcon,null)),/*#__PURE__*/React.createElement(\"h2\",{id:\"transition-modal-title\"},tag.name,\" - Contatos\"),/*#__PURE__*/React.createElement(TableContainer,{component:Paper},/*#__PURE__*/React.createElement(Table,null,/*#__PURE__*/React.createElement(TableHead,null,/*#__PURE__*/React.createElement(TableRow,null,/*#__PURE__*/React.createElement(TableCell,null,\"ID\"),/*#__PURE__*/React.createElement(TableCell,null,\"Nome\"),/*#__PURE__*/React.createElement(TableCell,null,\"Nmero\"),/*#__PURE__*/React.createElement(TableCell,null,\"A\\xE7\\xF5es\"))),/*#__PURE__*/React.createElement(TableBody,null,tagList===null||tagList===void 0?void 0:tagList.map(contact=>/*#__PURE__*/React.createElement(TableRow,{key:contact.id},/*#__PURE__*/React.createElement(TableCell,null,contact.id),/*#__PURE__*/React.createElement(TableCell,null,contact.name),/*#__PURE__*/React.createElement(TableCell,null,contact.number),/*#__PURE__*/React.createElement(TableCell,null,/*#__PURE__*/React.createElement(IconButton,{onClick:()=>handleRemoveContactTag(contact.id,tag.id)},/*#__PURE__*/React.createElement(DeleteIcon,null))))))))))):/*#__PURE__*/React.createElement(React.Fragment,null);};export default ContactTagListModal;","map":null,"metadata":{},"sourceType":"module"}